<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asiatop M&E</title>

    <link rel="icon" href="assets/icon.png" type="image/png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="preload" href="assets/hero-image-01.jpg" as="image">

    <style>
        body { 
            font-family: 'Poppins', sans-serif; 
            background-color: #f0f4f8; 
        }
        
        html, body {
            overflow-x: hidden;
        }
        .reveal-text > .word { transform: translateY(115%); transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .is-visible .reveal-text > .word { transform: translateY(0); }
        .delay-100 { transition-delay: 100ms !important; } .delay-200 { transition-delay: 200ms !important; } .delay-300 { transition-delay: 300ms !important; }
        @keyframes scroll-down-anim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(10px); } }
        .scroll-down-indicator { animation: scroll-down-anim 2s infinite; }
        
        .svg-connector { stroke-dasharray: 1000; stroke-dashoffset: 1000; transition: stroke-dashoffset 1.5s ease-in-out; }
        .is-visible .svg-connector { stroke-dashoffset: 0; }
        
        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            transform: scale(1.05);
            animation: kenburns 20s infinite;
        }
        .hero-slide.active { opacity: 1; }
        @keyframes kenburns {
            0% { transform: scale(1.05) translate(0, 0); }
            50% { transform: scale(1.15) translate(2%, -2%); }
            100% { transform: scale(1.05) translate(0, 0); }
        }
        

        #project-slider-track {
            user-select: none; /* Prevents text selection while dragging */
            -webkit-user-select: none;
            -ms-user-select: none;
            touch-action: pan-y; /* Allows vertical page scroll on touch */
        }

        .project-slide {
            flex: 0 0 100%; /* On mobile, 1 slide takes 100% width */
            padding: 0 0.75rem; /* (12px) gutter between slides */
            box-sizing: border-box;
            display: flex;  
            height: auto;
        }

        .project-card {
            background-color: #ffffff; /* Card is white */
            color: #1e293b; /* slate-800 text */
            border-radius: 1rem; /* 16px */
            overflow: hidden;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;           
            flex-direction: column; 
            height: 100%;            
            width: 100%;
        }
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.15);
        }

        .project-card-image {
            width: 100%;
            aspect-ratio: 16 / 10;
            object-fit: cover; /* Ensures image covers the area */
        }

        .project-card-content {
            padding: 1.5rem; /* 24px */
            flex-grow: 1;           /* Makes this section fill remaining space */
            display: flex;          /* Enables flex for inner content */
            flex-direction: column; /* Stacks title and description */
            justify-content: flex-start
        }

        .project-card-title {
            font-size: 1.25rem; /* 20px */
            font-weight: 600;
            margin-bottom: 0.5rem; /* 8px */
        }

        .project-card-description {
            font-size: 0.9rem; /* 14px */
            color: #475569; /* slate-600 */
            line-height: 1.6;
            margin-bottom: 1rem; /* 16px */
        }

        .project-card-button {
            display: inline-block;
            background-color: #0ea5e9; /* sky-500 */
            color: #ffffff;
            font-weight: 500;
            font-size: 0.875rem; /* 14px */
            padding: 0.6rem 1.25rem;
            border-radius: 9999px; /* full pill shape */
            text-decoration: none;
            transition: background-color 0.3s ease;
        }
        .project-card-button:hover {
            background-color: #0284c7; /* sky-600 */
        }

        /* Dot indicator styles */
        .project-dot {
            width: 0.75rem; /* 12px */
            height: 0.75rem;
            border-radius: 50%;
            background-color: rgba(0,0,0,0.2);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .project-dot.is-active {
            background-color: rgba(0,0,0,0.7);
        }

        /* On tablets and up (md), show 2 cards */
        @media (min-width: 768px) {
            .project-slide {
                flex-basis: 50%; /* 2 slides per view */
            }
        }

        /* On laptops and up (lg), show 3 cards */
        @media (min-width: 1024px) {
            .project-slide {
                flex-basis: 33.3333%; /* 3 slides per view */
            }
        }
        #process-animation-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1);
            transition: transform 0.3s ease;
        }
        @media (min-width: 1024px) {
            #process-animation-container {
                transform: translate(-50%, -50%) scale(1);
                top: 53%;
            }
        }
        @media (max-width: 1023px) {
            #process-animation-container {
                transform: translate(-50%, -50%) scale(1.43);
                top: 45%;
            }
            #process-header {
                top: 20%;
            }
        }

        @media (max-width: 768px) {
            #project-carousel-container {
                aspect-ratio: 10 / 11; /* Taller */
                perspective: 900px;
                margin: 1rem auto;
            }
            .project-card-carousel {
                width: 60%; /* Wider card on mobile */
                height: 70%;
                top: 15%;
            }
            .project-card-carousel.is-next {
                /* Adjusted horizontal offset from 45% to 40% */
                transform: translateX(calc(-50% + 40%)) translateZ(-100px) rotateY(-35deg) scale(0.8);
            }
            .project-card-carousel.is-prev {
                /* Adjusted horizontal offset from 45% to 40% */
                transform: translateX(calc(-50% - 40%)) translateZ(-100px) rotateY(35deg) scale(0.8);
            }
            /* Hide far-off cards on mobile */
            .project-card-carousel.is-next-next,
            .project-card-carousel.is-prev-prev {
                opacity: 0;
                transform: translateX(-50%) translateZ(-200px) scale(0.7);
            }
            .card-tilt-wrapper .card-content { 
                padding: 1rem 1rem; 
            }
            .card-tilt-wrapper .card-title { 
                font-size: 1rem; 
            }
            .card-tilt-wrapper .card-description { 
                font-size: 0.75rem; 
            }
            #process-animation-container {
                transform: translate(-50%, -50%) scale(1.35);
                width: 85vw;
                height: auto;
                top: 45%;
            }
            #process-header {
                top: 10%;
            }

            /* === MODIFICATION START === */
            /* 1. Stop the animation container from shifting left/right */
            .process-step[data-node="2"] #process-animation-container,
            .process-step[data-node="4"] #process-animation-container {
                transform: translate(-50%, -50%) scale(1.35);
            }

            /* 2. Force all text content to the 6 o'clock position */
            .process-step-content {
                /* Force new 6 o'clock position, overriding inline classes */
                top: calc(45% + 10rem) !important; 
                left: 50% !important;
                
                /* Clear old layout properties */
                right: auto !important;
                bottom: auto !important;
                
                /* Force center alignment and width */
                text-align: center !important;
                width: 80vw !important;
                max-width: 80vw !important;
                
                /* Set new base transform. 
                - We add translateX(-50%) to center it (since left: 50%).
                - We keep translateY(30px) and scale(0.9) from the original
                    .process-step-content rule so GSAP can animate from it.
                */
                transform: translateX(-50%) translateY(30px) scale(0.9) !important;
            }
            .project-card-carousel {
                width: 60%; /* Adjust card width */
                height: 70%; /* Adjust card height */
                top: 15%;
            }
           .project-card-carousel.is-next {
                transform: translateX(calc(-50% + 30%)) translateZ(-100px) rotateY(-30deg) scale(0.8);
            }
            .project-card-carousel.is-prev {
                transform: translateX(calc(-50% - 30%)) translateZ(-100px) rotateY(30deg) scale(0.8);
            }
            /* Hide further cards on mobile */
            .project-card-carousel.is-next-next,
            .project-card-carousel.is-prev-prev {
                transform: translateX(-50%) translateZ(-400px) scale(0.7); /* Match default */
                opacity: 0;
                z-index: 1;
            }
            .project-card-carousel::after { font-size: 0.8rem; padding: 1rem 0.8rem 0.8rem; }
            .project-card-carousel .card-content { padding: 1rem 1rem; }
            .project-card-carousel .card-title { font-size: 1rem; }
            .project-card-carousel .card-description { font-size: 0.75rem; }
        }

        @media (max-width: 480px) {
            #process-animation-container {
                transform: translate(-50%, -50%) scale(1.27);
            }
        }
        /* === START: NEW PROCESS SECTION STYLES === */
        #process {
            background-image: none; /* Explicitly remove it */
        }

        /* 2. Set the background on the pinned element */
        #process-pinned-element {
            background-color: #ffffff;
            /* We DO NOT change its position or z-index */
        }

        /* 3. Position the particle canvas */
        #particles-container {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Set it to the base z-index */
        }

        /* * 4. THE FIX:
        * We ONLY lift the elements that are position: absolute.
        * We DO NOT touch #process-animation-container,
        * which is position: relative and has complex mobile logic.
        */
        #process-header,
        .process-step-content {
            z-index: 1; /* Lift just these elements */
        }
        .process-step {
            opacity: 0.2; /* Inactive steps are faded out */
            min-height: 60vh; /* Give each step space to scroll through */
            display: flex;
            align-items: center;
        }
        .process-step.is-active {
            opacity: 1; /* Active step is fully visible */
        }
        #circle-progress {
            /* Full circumference of a circle with radius 180 is 2 * PI * 180 ‚âà 1131 */
            stroke-dasharray: 1131;
            stroke-dashoffset: 1131;
            transform-origin: center;
            transform: rotate(-90deg); /* Start drawing from the top */
        }
        .process-node circle {
            transition: fill 0.4s ease, transform 0.4s ease;
        }
        .process-step-content {
            opacity: 0;
            /* Start slightly further away and scaled down */
            transform: translateY(30px) scale(0.9);
        }
        #process-central-icon svg {
            width: 4rem;
            height: 4rem;
            opacity: 0;
            transform: scale(0.8);
        }
        .process-node.is-active circle {
            fill: #0ea5e9; /* sky-500 */
            transform-origin: center;
            transform: scale(1.4);
        }
        .process-node.is-active text {
            fill: white;
        }
        /* === END: NEW PROCESS SECTION STYLES === */
    </style>
</head>
<body class="text-slate-800 antialiased">

    <header id="main-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 text-white">
        <div class="container mx-auto px-6 py-5 flex justify-between items-center">
            <a href="#home" class="flex items-center gap-3">
                <img src="assets/asiatop.png" alt="Asiatop M&E Logo" class="h-10 w-auto">
                <div>
                    <div class="font-bold text-sm leading-tight tracking-wider">ASIA TOP & TECHNOLOGY</div>
                    <div class="text-xs leading-tight tracking-wider">ENGINEERING SDN BHD</div>
                </div>
            </a>

            <nav class="hidden lg:flex items-center space-x-10 font-medium">
                <a href="#about" class="nav-link">About</a>
                <a href="#services" class="nav-link">Services</a>
                <a href="#projects" class="nav-link">Projects</a>
                <a href="#process" class="nav-link">Process</a>
                <a href="#contact" class="nav-link">Contact</a>
            </nav>

            <button id="mobile-menu-button" class="lg:hidden">
                <svg
                    class="h-7 w-7"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16m-7 6h7"
                    />
                </svg>
            </button>

            </div>

            <div
                id="mobile-menu"
                class="hidden lg:hidden bg-white/95 backdrop-blur-lg text-slate-800"
            >
                <a href="#about" class="block py-3 px-6 hover:bg-slate-100">About</a>
                <a href="#services" class="block py-3 px-6 hover:bg-slate-100">Services</a>
                <a href="#projects" class="block py-3 px-6 hover:bg-slate-100">Projects</a>
                <a href="#process" class="block py-3 px-6 hover:bg-slate-100">Process</a>
                <a href="#contact" class="block py-3 px-6 hover:bg-slate-100">Contact</a>
            </div>

    </header>

    <main>
        <section id="home" class="h-screen flex items-center justify-center relative overflow-hidden">
            <div id="hero-slideshow">
                <div class="hero-slide active" style="background-image: url('assets/hero-image-01.jpg');"></div>
                <div class="hero-slide" style="background-image: url('assets/hero-image-01.jpg');"></div>
                <div class="hero-slide" style="background-image: url('assets/hero-image-01.jpg');"></div>
            </div>
            <div class="absolute inset-0 bg-black/60"></div>
            <div class="text-center text-white z-10 px-4 relative">
                
                <h1
                    class="text-4xl md:text-7xl font-extrabold leading-tight mb-4
                        drop-shadow-2xl reveal-text"
                >
                    <span class="word inline-block">Engineering</span>
                    <span class="word inline-block delay-100">Tomorrow's</span>
                    <span class="word inline-block delay-200">Landmarks.</span>
                </h1>

                <p
                    class="text-lg md:text-xl text-slate-200 mb-8 max-w-3xl mx-auto
                        reveal-text"
                >
                    <span class="word inline-block delay-300">
                        We are the architects of integration, engineering complex systems
                        that power the future.
                    </span>
                </p>

                <div class="reveal-text">
                    <a
                        href="#projects"
                        class="word inline-block delay-300 bg-amber-500 hover:bg-amber-600 text-white
                            text-white font-bold py-4 px-10 rounded-full
                            transition duration-300 text-lg transform hover:scale-105
                            shadow-xl"
                    >
                        View Our Work
                    </a>
                </div>
            </div>

            <div
                class="scroll-down-indicator absolute bottom-10 left-1/2
                    -translate-x-1/2 z-10"
            >
                <svg
                    class="w-8 h-8 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 14l-7 7m0 0l-7-7m7 7V3"
                    ></path>
                </svg>
            </div>
        </section>

        <section id="about" class="py-24 lg:py-40 bg-white">
            <div class="container mx-auto px-6 grid lg:grid-cols-2 gap-16 items-center">

                <div class="relative">
                <div class="absolute -top-6 -left-6 w-full h-full bg-slate-200 rounded-3xl transform -rotate-3 z-0"></div>
                <img 
                    src="assets/handshake.jpg" 
                    alt="Business handshake" 
                    class="relative rounded-3xl shadow-2xl w-full h-auto object-cover z-10"
                >
                </div>

                <div class="lg:pl-12">
                <h2 class="text-4xl lg:text-5xl font-extrabold text-slate-900 mb-6 leading-tight">
                    About Us
                </h2>
                <p class="text-slate-600 mb-8 text-lg leading-relaxed">
                   Asia Top & Technology Engineering Sdn Bhd (ASIATOP) is a trusted Electrical & Mechanical (E&M) contractor with 17+ years of experience. 
                   Since its incorporation in 2005, ASIATOP has delivered reliable engineering solutions for domestic, commercial, and new development projects. 
                   Backed by a visionary founder and a team of dedicated professionals, the company is known for consistent quality, strong industry trust, 
                   and value-driven solutions through close collaboration with clients, consultants, and partners.
                </p>
                <a 
                    href="#contact" 
                    class="inline-block font-semibold text-sky-600 hover:text-sky-800 transition-colors text-lg"
                >
                    Partner with us &rarr;
                </a>
                </div>

            </div>
        </section>
        
        <section id="services" class="py-24 lg:py-32" style="background-image: linear-gradient(rgba(240, 244, 248, 0.95), rgba(240, 244, 248, 0.95)), url('https://www.transparenttextures.com/patterns/cubes.png');"><div class="container mx-auto px-6"><div class="text-center mb-16"><h2 class="text-4xl lg:text-5xl font-bold text-slate-900">Our Services</h2><p class="text-slate-600 mt-4 max-w-2xl mx-auto text-lg">A complete range of M&E services for seamless integration and optimal performance.</p></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                <img src="assets/lighting.png" alt="Power Distribution Icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">Power Distribution</h3>
                <p class="text-slate-600 leading-relaxed">High-voltage transformers to final LV outlets, ensuring robust and reliable power infrastructure.</p>
            </div>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                <img src="assets/telecomunication.png" alt="Telecommunications Icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">Telecommunications</h3>
                <p class="text-slate-600 leading-relaxed">Integrated PABX, public address, MATV, and structured cabling for seamless connectivity.</p>
            </div>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                    <img src="assets/building.png" alt="Building & Security Icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">Building & Security</h3>
                <p class="text-slate-600 leading-relaxed">Advanced CCTV, building control systems, and smart equipment for intelligent facility management.</p>
            </div>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                <img src="assets/clean-air.png" alt="HVAC icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">HVAC & Ventilation</h3>
                <p class="text-slate-600 leading-relaxed">From unitary systems to large-scale chilled water plants for optimal climate control.</p>
            </div>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                <img src="assets/extinguisher.png" alt="Fire Extinguisher Icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">Fire Safety Systems</h3>
                <p class="text-slate-600 leading-relaxed">Comprehensive fire detection, alarm, and advanced fire fighting systems to protect assets.</p>
            </div>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
                <div class="bg-sky-100 text-sky-600 rounded-full h-16 w-16 flex items-center justify-center mb-6">
                <img src="assets/plumbing-maintenance.png" alt="Plumbing Icon" class="h-8 w-8 object-contain">
                </div>
                <h3 class="text-xl font-semibold mb-3 text-slate-900">Plumbing & Water</h3>
                <p class="text-slate-600 leading-relaxed">Clean water distribution, treatment, pressure boosting, drainage, and sewage management systems.</p>
            </div>
        </div></div></section>
        
        <section id="projects" class="bg-slate-100 text-slate-900 py-24 lg:py-40 relative overflow-hidden">
            <div class="container mx-auto px-6">
                
                <div class="text-center mb-16">
                    <h2 class="text-4xl lg:text-5xl font-bold">Featured Projects</h2>
                    <p class="text-slate-600 mt-4 max-w-2xl mx-auto text-lg">A showcase of our engineering capabilities across various sectors.</p>
                </div>

                <div class="relative max-w-6xl mx-auto">
                    
                    <div id="project-slider-viewport" class="overflow-hidden">
                        
                        <div id="project-slider-track" class="flex cursor-grab active:cursor-grabbing">
                            </div>
                    </div>

                    <button id="project-prev" class="hidden lg:block absolute top-1/2 left-0 -translate-y-1/2 -translate-x-3 lg:-translate-x-16 bg-white/50 hover:bg-white/90 text-slate-900 p-3 rounded-full transition-all z-20 shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    </button>
                    <button id="project-next" class="hidden lg:block absolute top-1/2 right-0 -translate-y-1/2 translate-x-3 lg:translate-x-16 bg-white/50 hover:bg-white/90 text-slate-900 p-3 rounded-full transition-all z-20 shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                </div>

                <div id="project-slider-dots" class="flex justify-center gap-2 mt-8">
                    </div>
            </div>
        </section>
        
        <section id="process" class="bg-white relative">
            <div id="process-scroll-wrapper" class="relative h-[400vh]">

                <div id="process-pinned-element" class="sticky top-0 w-full h-screen flex flex-col items-center justify-center overflow-hidden">
                    <div id="particles-container"></div>
                    <div id="process-header" class="text-center absolute top-[15%] lg:top-[15%] px-4 opacity-0">
                        <h2 class="text-4xl lg:text-5xl font-bold text-slate-900">Our Proven Process</h2>
                        <p class="text-slate-600 mt-4 max-w-2xl mx-auto text-lg">From concept to completion, our structured methodology ensures excellence at every stage.</p>
                    </div>

                    <div id="process-animation-container" class="relative w-full h-full flex items-center justify-center">
                        
                        <div class="relative w-64 h-64 lg:w-96 lg:h-96">
                            <svg id="process-svg" viewBox="0 0 400 400" class="absolute inset-0 w-full h-full">
                                <defs><pattern id="dot-pattern" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="2" cy="2" r="1.5" fill="#e2e8f0"></circle></pattern></defs>
                                <rect id="dot-bg" width="400" height="400" fill="url(#dot-pattern)" opacity="0"></rect>
                                <circle id="ring-3" cx="200" cy="200" r="180" fill="none" stroke="#f1f5f9" stroke-width="40" opacity="0.5"/>
                                <circle id="ring-2" cx="200" cy="200" r="120" fill="none" stroke="#f8fafc" stroke-width="40" opacity="0.75"/>
                                <circle id="ring-1" cx="200" cy="200" r="60" fill="white" />
                                <path id="circle-progress" d="M 200, 20 a 180,180 0 1,1 0,360 a 180,180 0 1,1 0,-360" fill="none" stroke="#0ea5e9" stroke-width="8" stroke-linecap="round" />
                                <g class="process-node" id="node-1"><circle cx="200" cy="20" r="12" fill="#cbd5e1"/><text x="200" y="25" text-anchor="middle" font-size="14" fill="black" font-weight="bold">1</text></g>
                                <g class="process-node" id="node-2"><circle cx="380" cy="200" r="12" fill="#cbd5e1"/><text x="380" y="205" text-anchor="middle" font-size="14" fill="black" font-weight="bold">2</text></g>
                                <g class="process-node" id="node-3"><circle cx="200" cy="380" r="12" fill="#cbd5e1"/><text x="200" y="385" text-anchor="middle" font-size="14" fill="black" font-weight="bold">3</text></g>
                                <g class="process-node" id="node-4"><circle cx="20" cy="200" r="12" fill="#cbd5e1"/><text x="20" y="205" text-anchor="middle" font-size="14" fill="black" font-weight="bold">4</text></g>
                            </svg>
                            <div id="process-central-icon" class="absolute inset-0 flex items-center justify-center text-sky-500"></div>
                        </div>

                        <div id="step-content-1" class="process-step-content absolute inset-x-0 bottom-[calc(50%+12rem)] lg:bottom-[calc(50%+15rem)] px-6 text-center max-w-sm mx-auto">
                            <h3 class="text-xl lg:text-2xl font-bold mb-2 text-slate-800"><span class="text-sky-500">01.</span> Consultation</h3><p class="text-sm lg:text-base text-slate-600">We begin by understanding your vision, establishing a clear roadmap for success.</p>
                        </div>
                        <div id="step-content-2" class="process-step-content absolute top-1/2 left-[calc(50%+9rem)] lg:left-[calc(50%+15rem)] -translate-y-1/2 text-left w-4/12 max-w-[10rem] lg:max-w-xs">
                            <h3 class="text-xl lg:text-2xl font-bold mb-2 text-slate-800"><span class="text-sky-500">02.</span> Design & Engineering</h3><p class="text-sm lg:text-base text-slate-600">Our experts craft bespoke, efficient, and sustainable system designs tailored to your unique goals.</p>
                        </div>
                        <div id="step-content-3" class="process-step-content absolute inset-x-0 top-[calc(50%+12rem)] lg:top-[calc(50%+15rem)] px-6 text-center max-w-sm mx-auto">
                            <h3 class="text-xl lg:text-2xl font-bold mb-2 text-slate-800"><span class="text-sky-500">03.</span> Execution</h3><p class="text-sm lg:text-base text-slate-600">Meticulous project management ensures on-time, on-budget delivery and skilled on-site execution.</p>
                        </div>
                        <div id="step-content-4" class="process-step-content absolute top-1/2 right-[calc(50%+9rem)] lg:right-[calc(50%+15rem)] -translate-y-1/2 text-left w-4/12 max-w-[10rem] lg:max-w-xs">
                            <h3 class="text-xl lg:text-2xl font-bold mb-2 text-slate-800"><span class="text-sky-500">04.</span> Quality Assurance</h3><p class="text-sm lg:text-base text-slate-600">Rigorous testing, system integration, and final handover guarantee optimal, long-term performance.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        </div><svg class="absolute hidden md:block top-8 left-0 w-full h-auto z-0" viewBox="0 0 1000 20"><path class="svg-connector" d="M 125 10 H 875" stroke="#cbd5e1" stroke-width="4" fill="none" stroke-linecap="round"/></svg></div></div></section>

        <section id="contact" class="py-24 lg:py-40 bg-slate-900 text-white"><div class="container mx-auto px-6"><div class="text-center mb-16"><h2 class="text-4xl lg:text-5xl font-bold">Start Your Next Project</h2><p class="text-slate-400 mt-4 max-w-2xl mx-auto text-lg">Let's discuss how our expertise can bring your vision to life. Reach out for a consultation.</p></div><div class="max-w-6xl mx-auto grid lg:grid-cols-5 gap-16 items-start">
            <div class="lg:col-span-2 space-y-8"><div class="flex items-start gap-4"><div class="bg-sky-500/20 text-sky-400 p-3 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg></div><div><h3 class="font-semibold text-xl">Our Office</h3><p class="text-slate-400">Lot D-30A-2, 2nd Floor, Block D, Pavilion Bundusan, Jalan Bunsudan, 88300 Kota Kinabalu</p></div></div><div class="flex items-start gap-4"><div class="bg-sky-500/20 text-sky-400 p-3 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div><div><h3 class="font-semibold text-xl">Email Us</h3><p class="text-slate-400">projects@asiatop.com</p></div></div></div>
           <form 
                id="contact-form"
                action="https://api.web3forms.com/submit" 
                method="POST" 
                class="lg:col-span-3 bg-slate-800 p-8 rounded-xl shadow-2xl relative transition-all duration-300"
            >
                <input type="hidden" name="access_key" value="28878228-55ec-4edd-b360-f1a363a5dd56">
                <input type="checkbox" name="botcheck" class="hidden" style="display: none;">

                <div id="form-content" class="space-y-6 transition-opacity duration-300 ease-in-out">
                    <div class="grid sm:grid-cols-2 gap-6">
                        <input 
                            type="text" 
                            name="name" 
                            required
                            placeholder="Your Name" 
                            class="w-full bg-slate-700 text-white p-4 border border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 transition"
                        >
                        <input 
                            type="email" 
                            name="email" 
                            required
                            placeholder="Your Email" 
                            class="w-full bg-slate-700 text-white p-4 border border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 transition"
                        >
                    </div>

                    <textarea 
                        name="message" 
                        required
                        placeholder="Your Message" 
                        rows="5" 
                        class="w-full bg-slate-700 text-white p-4 border border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 transition"
                    ></textarea>

                    <button 
                        type="submit" 
                        id="form-submit-btn"
                        class="w-full bg-sky-500 hover:bg-sky-600 font-bold py-4 px-10 rounded-lg transition-all duration-300 text-lg transform hover:scale-105 shadow-lg"
                    >
                        Send Message
                    </button>
                    <div id="form-error-msg" class="hidden text-center text-red-400 mt-2"></div>
                </div>

                <div id="success-message" class="hidden w-full flex-col items-center justify-center text-center py-12 opacity-0 transition-opacity duration-500">
                    
                    <div class="bg-green-500/20 p-4 rounded-full mb-6 animate-bounce">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    
                    <h3 class="text-3xl font-bold text-white mb-4">Message Sent!</h3>
                    <p class="text-slate-400 mb-8 max-w-md mx-auto text-lg">Thank you for reaching out. We'll get back to you shortly.</p>
                    
                    <button 
                        type="button" 
                        id="reset-form-btn"
                        class="text-sky-400 hover:text-sky-300 font-semibold transition-colors flex items-center gap-2 mx-auto"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                        Send another message
                    </button>
                </div>
            </form>
        </div></div>
        </section>
    </main>

    <footer class="bg-slate-900 text-slate-400 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-6 py-16 lg:py-24">

            <div class="grid gap-8 lg:grid-cols-3 lg:gap-20">

                <div>
                    <h3 class="text-2xl font-bold text-white tracking-wide leading-tight mb-4">
                        ASIA TOP & TECHNOLOGY<br />
                        ENGINEERING SDN BHD
                    </h3>

                    <p class="text-sm leading-relaxed max-w-sm mb-6">
                        Crafting the future of engineered environments with precision,
                        passion, and sustainable innovation.
                    </p>

                    <span class="inline-block bg-slate-800 border border-slate-700 rounded px-3 py-1 text-xs text-slate-300">
                        Est. 2025 ‚Ä¢ Licensed Engineering Firm
                    </span>
                </div>

                <div class="grid grid-cols-1 gap-6 text-sm lg:grid-cols-2 lg:gap-8">
                    
                    <div class="
                        bg-slate-800/70 border border-slate-700 rounded-xl p-6
                        lg:bg-transparent lg:border-0 lg:rounded-none lg:p-0
                    ">
                        <h4 class="text-white font-semibold mb-4">Company</h4>
                        <ul class="space-y-3">
                            <li><a href="#" class="hover:text-white transition">About Us</a></li>
                            <li><a href="#" class="hover:text-white transition">Projects</a></li>
                            <li><a href="#" class="hover:text-white transition">Careers</a></li>
                            <li><a href="#" class="hover:text-white transition">Contact</a></li>
                        </ul>
                    </div>

                    <div class="
                        bg-slate-800/70 border border-slate-700 rounded-xl p-6
                        lg:bg-transparent lg:border-0 lg:rounded-none lg:p-0
                    ">
                        <h4 class="text-white font-semibold mb-4">Services</h4>
                        <ul class="space-y-3 text-sm">
                            <li>Power Distribution</li>
                            <li>Telecommunication Systems</li>
                            <li>Supporting Equipment</li>

                            <li class="relative">
                                <div class="relative inline-block group cursor-pointer">
                                    <span class="block">More...</span>
                                    <ul class="absolute left-0 mt-1 w-52 bg-slate-800 text-slate-300 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                                        <li class="px-4 py-2 hover:bg-slate-700 rounded">Plumbing & Sanitary</li>
                                        <li class="px-4 py-2 hover:bg-slate-700 rounded">HVAC</li>
                                        <li class="px-4 py-2 hover:bg-slate-700 rounded">Fire Safety Systems</li>
                                        <li class="px-4 py-2 hover:bg-slate-700 rounded">Water & Sewage</li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="
                    bg-slate-800/70 border border-slate-700 rounded-xl p-6
                    lg:bg-transparent lg:border-0 lg:rounded-none lg:p-0
                ">
                    <h4 class="text-white font-semibold mb-5">Get in Touch</h4>

                    <ul class="space-y-4 text-sm">
                        <li class="flex gap-3">
                            <span>üìç</span>
                            <span>Lot D-30A-2, Pavilion Bundusan, Kota Kinabalu</span>
                        </li>
                        <li class="flex gap-3">
                            <span>‚úâÔ∏è</span>
                            <span>info@asiatop.com</span>
                        </li>
                        <li class="flex gap-3">
                            <span>üìû</span>
                            <span>088-739736</span>
                        </li>
                    </ul>

                    <a href="#contact" class="
                        mt-8 block text-center bg-sky-600 hover:bg-sky-500
                        text-white font-semibold text-sm uppercase tracking-wide
                        px-6 py-3 rounded-lg transition
                    ">
                        Request Consultation
                    </a>
                </div>

            </div>

            <div class="
                mt-16 pt-6 border-t border-slate-800
                flex flex-col gap-4
                lg:flex-row lg:items-center lg:justify-between
                text-xs text-slate-500
            ">
                <p>¬© 2026 Asia Top & Technology Engineering Sdn Bhd. All rights reserved.</p>

                <div class="flex gap-6">
                    <a href="#" class="hover:text-white transition">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition">Terms of Service</a>
                </div>
            </div>

        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

    <script>
        const form = document.getElementById('contact-form');
        const formContent = document.getElementById('form-content');
        const successMessage = document.getElementById('success-message');
        const submitBtn = document.getElementById('form-submit-btn');
        const resetBtn = document.getElementById('reset-form-btn');
        const errorMsg = document.getElementById('form-error-msg');
        const originalBtnText = submitBtn.innerText;

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 1. Loading State
            submitBtn.innerText = "Sending...";
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-70', 'cursor-not-allowed');

            const formData = new FormData(form);
            const object = Object.fromEntries(formData);
            const json = JSON.stringify(object);

            fetch('https://api.web3forms.com/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: json
            })
            .then(async (response) => {
                let json = await response.json();
                if (response.status == 200) {
                    // 2. Success Animation
                    
                    // Fade out form content
                    formContent.style.opacity = '0';
                    
                    setTimeout(() => {
                        // Hide form content completely
                        formContent.classList.add('hidden');
                        
                        // Show success message (but keep opacity 0 for a moment)
                        successMessage.classList.remove('hidden');
                        successMessage.style.display = 'flex'; // Ensure flex layout
                        
                        // Trigger fade in
                        setTimeout(() => {
                            successMessage.classList.remove('opacity-0');
                        }, 50);
                        
                        form.reset(); 
                    }, 300); // Wait for fade out to finish

                } else {
                    errorMsg.innerText = json.message || "Something went wrong.";
                    errorMsg.classList.remove('hidden');
                }
            })
            .catch(error => {
                console.log(error);
                errorMsg.innerText = "Connection error. Please try again.";
                errorMsg.classList.remove('hidden');
            })
            .finally(() => {
                submitBtn.innerText = originalBtnText;
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-70', 'cursor-not-allowed');
            });
        });

        // Reset button logic
        resetBtn.addEventListener('click', () => {
            successMessage.classList.add('opacity-0');
            
            setTimeout(() => {
                successMessage.classList.add('hidden');
                successMessage.style.display = 'none';
                
                formContent.classList.remove('hidden');
                
                setTimeout(() => {
                    formContent.style.opacity = '1';
                    errorMsg.classList.add('hidden');
                }, 50);
            }, 300);
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

            if (document.getElementById('particles-container')) {
                particlesJS('particles-container', {
                    "particles": {
                        "number": {
                            "value": 80, // More particles
                            "density": {
                                "enable": true,
                                "value_area": 800 // Adjusts density based on screen size
                            }
                        },
                        "color": {
                            "value": "#0ea5e9" // Your theme's sky-500 color
                        },
                        "shape": {
                            "type": "circle"
                        },
                        "opacity": {
                            "value": 0.6, // More visible dots
                            "random": true,
                        },
                        "size": {
                            "value": 3,
                            "random": true
                        },
                        "line_linked": {
                            "enable": true,
                            "distance": 150,
                            "color": "#bae6fd", // Your theme's sky-200 color
                            "opacity": 0.4,
                            "width": 1
                        },
                        "move": {
                            "enable": true,
                            "speed": 1.5, // A nice, steady speed
                            "direction": "none",
                            "random": false,
                            "straight": false,
                            "out_mode": "out",
                            "bounce": false
                        }
                    },
                    "interactivity": {
                        "detect_on": "canvas",
                        "events": {
                            "onhover": {
                                "enable": true, // Adds a nice "grab" effect on PC
                                "mode": "grab"
                            },
                            "onclick": {
                                "enable": false // No click effect
                            },
                            "resize": true // This is key for responsiveness
                        },
                        "modes": {
                            "grab": {
                                "distance": 140,
                                "line_linked": {
                                    "opacity": 1
                                }
                            }
                        }
                    },
                    "retina_detect": true
                });
            }
            // --- Header Scroll Logic (No changes) ---
            ScrollTrigger.create({
                start: "top top", end: 99999,
                onUpdate: self => {
                    const header = document.getElementById('main-header');
                    if (self.scroll() > 50) {
                        header.classList.add('bg-white/95', 'backdrop-blur-lg', 'shadow-md', 'text-slate-800');
                        header.classList.remove('text-white');
                    } else {
                        header.classList.remove('bg-white/95', 'backdrop-blur-lg', 'shadow-md', 'text-slate-800');
                        header.classList.add('text-white');
                    }
                }
            });
            
            // --- Hero Slideshow (No changes) ---
            const heroSlides = document.querySelectorAll('.hero-slide');
            let currentHeroSlide = 0;
            setInterval(() => {
                heroSlides[currentHeroSlide].classList.remove('active');
                currentHeroSlide = (currentHeroSlide + 1) % heroSlides.length;
                heroSlides[currentHeroSlide].classList.add('active');
            }, 5000);

            // --- Mobile Menu Toggle (No changes) ---
            document.getElementById('mobile-menu-button').addEventListener('click', () => { document.getElementById('mobile-menu').classList.toggle('hidden'); });
            document.querySelectorAll('#mobile-menu a').forEach(link => { link.addEventListener('click', () => document.getElementById('mobile-menu').classList.add('hidden')); });

            // --- Intersection Observer for ONE-TIME Animations (No changes) ---
            const generalObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => { 
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        generalObserver.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.2 });
            document.querySelectorAll('#home').forEach(el => generalObserver.observe(el)); 

            // --- START: FINAL GSAP SCROLL-DRIVEN PROCESS TIMELINE ---
          if (document.getElementById('process-scroll-wrapper')) {
                gsap.registerPlugin(ScrollTrigger);

                const steps = gsap.utils.toArray(".process-step-content");
                const nodes = gsap.utils.toArray(".process-node");
                const centralIcon = document.getElementById('process-central-icon');

                // UPDATED: Local Paths
                const icons = [
                    `<img src="assets/conversation.png" alt="Consultation" class="w-16 h-16 object-contain" />`,
                    `<img src="assets/design-thinking.png" alt="Design" class="w-16 h-16 object-contain" />`,
                    `<img src="assets/execution.png" alt="Execution" class="w-16 h-16 object-contain" />`,
                    `<img src="assets/quality-assurance.png" alt="QA" class="w-16 h-16 object-contain" />`,
                ];

                // Helper to update Icon AND Node Classes
                const updateStep = (index) => {
                    // 1. Update Icon
                    centralIcon.innerHTML = icons[index];
                    
                    // 2. Animate the new PNG (Changed 'svg' to 'img')
                    gsap.fromTo(centralIcon.querySelector('img'), 
                        { opacity: 0, scale: 0.8 }, 
                        { opacity: 1, scale: 1, duration: 0.5, ease: 'back.out(1.7)' }
                    );

                    // 3. Update the little grey/blue dots (Nodes)
                    nodes.forEach(n => n.classList.remove('is-active'));
                    if(nodes[index]) nodes[index].classList.add('is-active');
                };

                let masterTl = gsap.timeline({
                    scrollTrigger: {
                        trigger: "#process-scroll-wrapper",
                        start: "top top",
                        end: "bottom bottom",
                        scrub: 1.5,
                        pin: "#process-pinned-element",
                    }
                });

                // Intro Animation
                masterTl
                    .to("#process-header", { opacity: 1, duration: 1 })
                    .to("#dot-bg", { opacity: 0.6, duration: 1 }, "-=0.5")
                    .to(["#ring-1", "#ring-2", "#ring-3"], { attr: { r: (i) => [80, 130, 180][i] }, duration: 2, ease: 'power2.inOut' }, "-=1")
                    .to("#process-header", { opacity: 0, duration: 1 }, "+=1");

                // Main Steps Loop
                steps.forEach((step, index) => {
                    masterTl
                        .to(step, { 
                            opacity: 1, 
                            y: 0, 
                            scale: 1, 
                            duration: 1, 
                            ease: 'power2.out',
                            
                            // Trigger icon change immediately when this step STARTS
                            onStart: () => {
                                updateStep(index);
                            },
                            // Handle reversing the icon/node when scrolling back up
                            onReverseComplete: () => {
                                if (index > 0) {
                                    // If reversing from 2->1, 3->2, etc.
                                    updateStep(index - 1);
                                } else {
                                    // If reversing from 1->0 (Back to start)
                                    centralIcon.innerHTML = ''; // Remove the image completely
                                    nodes[index].classList.remove('is-active'); // Turn off the first dot
                                }
                            }
                        })
                        .to("#circle-progress", { strokeDashoffset: 1131 * (1 - (index + 1) / steps.length), duration: 4, ease: 'none' }, "-=1")
                        .to(step, { opacity: 0, y: -20, scale: 0.95, duration: 1, ease: 'power2.in' }, "+=2");
                });

                // Outro Animation
                masterTl
                    .to(nodes, { autoAlpha: 0, duration: 0.5 })
                    .to(["#ring-1", "#ring-2", "#ring-3"], { attr: { r: (i) => [60, 120, 180][i] }, duration: 2, ease: 'power2.inOut' })
                    .to("#dot-bg", { opacity: 0, duration: 1 }, "-=1")
                    // Changed 'svg' to 'img' here too just in case
                    .to("#process-central-icon img", { opacity: 0, scale: 0.8, duration: 0.5 }, "<");
            }
            // --- END: CORRECTED GSAP SCROLL-DRIVEN PROCESS TIMELINE ---

            /* === START: NEW PROJECT SLIDER LOGIC (UPDATED WITH SWIPE DETECTION) === */
            const projectSliderContainer = document.getElementById('project-slider-track');

            if (projectSliderContainer) {
                const projectData = [
                    { title: "Integrated Power Grid", description: "A state-of-the-art power distribution system for a new industrial park.", image: `{{ asset('project-1.jpeg') }}`, link: "#" },
                    { title: "Telecommunication Hub", description: "Structured cabling and PABX system for a major corporate headquarters.", image: `{{ asset('project-2.jpeg') }}`, link: "#" },
                    { title: "Smart Building Security", description: "Advanced CCTV and building control systems for a high-security government facility.", image: `{{ asset('project-3.jpeg') }}`, link: "#" },
                    { title: "Data Center HVAC", description: "Precision climate control and ventilation for a Tier IV data center.", image: `{{ asset('project-4.jpeg') }}`, link: "#" },
                    { title: "High-Rise Fire Safety", description: "A comprehensive fire detection, alarm, and suppression system for a 50-story tower.", image: `{{ asset('project-5.jpeg') }}`, link: "#" },
                    { title: "Water Treatment Plant", description: "Clean water distribution and treatment infrastructure for a new township.", image: `{{ asset('project-6.jpeg') }}`, link: "#" },
                ];

                const sliderTrack = document.getElementById('project-slider-track');
                const dotsContainer = document.getElementById('project-slider-dots');
                const nextButton = document.getElementById('project-next');
                const prevButton = document.getElementById('project-prev');
                const viewport = document.getElementById('project-slider-viewport');

                let slidesPerView = 3;
                let currentSlide = 0;
                let realSlideCount = projectData.length;
                let autoSlideInterval;
                let dots = [];
                let isAnimating = false;

                // --- Dragging State ---
                let isDragging = false;
                let startPos = 0;
                let startTime = 0; // Added for swipe velocity
                let currentTranslate = 0;
                let prevTranslate = 0;
                let dragOffset = 0;
                let slideWidth = 0;
                // --- Animation Frame ---
                let animationFrameId = 0;
                let isMoving = false;

                // 1. HELPER FUNCTIONS
                const updateSlidesPerView = () => {
                    if (window.innerWidth < 768) slidesPerView = 1;
                    else if (window.innerWidth < 1024) slidesPerView = 2;
                    else slidesPerView = 3;
                };

                const buildSlider = () => {
                    updateSlidesPerView();
                    
                    const originalSlides = projectData.map(project => createSlideHTML(project, slidesPerView));
                    
                    if (realSlideCount > slidesPerView) {
                        const firstClones = projectData.slice(0, slidesPerView).map(project => createSlideHTML(project, slidesPerView));
                        const lastClones = projectData.slice(-slidesPerView).map(project => createSlideHTML(project, slidesPerView));
                        sliderTrack.innerHTML = [...lastClones, ...originalSlides, ...firstClones].join('');
                        currentSlide = slidesPerView;
                    } else {
                        sliderTrack.innerHTML = originalSlides.join('');
                        currentSlide = 0;
                    }
                    
                    slideWidth = sliderTrack.querySelector('.project-slide').offsetWidth;
                    
                    goToSlide(currentSlide, true);
                    createDots();
                };

                const createSlideHTML = (project, slides) => {
                    const flexBasis = 100 / slides;
                    return `
                        <div class="project-slide" style="flex-basis: ${flexBasis}%;">
                            <div class="project-card">
                                <img src="${project.image}" alt="${project.title}" class="project-card-image" draggable="false">
                                <div class="project-card-content">
                                    <h3 class="project-card-title">${project.title}</h3>
                                    <p class="project-card-description">${project.description}</p>
                                </div>
                            </div>
                        </div>
                    `;
                };

                const createDots = () => {
                    dotsContainer.innerHTML = '';
                    dots = [];
                    const numDots = Math.ceil(realSlideCount / slidesPerView);
                    if (numDots <= 1) return;
                    
                    for (let i = 0; i < numDots; i++) {
                        const dot = document.createElement('button');
                        dot.className = 'project-dot';
                        dot.addEventListener('click', () => {
                            let targetSlide = i * slidesPerView;
                            if (realSlideCount > slidesPerView) {
                                targetSlide += slidesPerView;
                            }
                            goToSlide(targetSlide);
                            stopAutoSlide();
                        });
                        dotsContainer.appendChild(dot);
                        dots.push(dot);
                    }
                    updateDots();
                };
                
                const updateDots = () => {
                    let realCurrentSlide = 0;
                    if (realSlideCount > slidesPerView) {
                        realCurrentSlide = (currentSlide - slidesPerView + realSlideCount) % realSlideCount;
                    } else {
                        realCurrentSlide = currentSlide % realSlideCount;
                    }
                    const activeDotPage = Math.floor(realCurrentSlide / slidesPerView);
                    dots.forEach((dot, i) => dot.classList.toggle('is-active', i === activeDotPage));
                };

                const goToSlide = (slideIndex, instant = false) => {
                    if (isAnimating) return;
                    isAnimating = true;

                    currentSlide = slideIndex;
                    currentTranslate = -currentSlide * slideWidth;
                    prevTranslate = currentTranslate;

                    sliderTrack.style.transition = instant ? 'none' : 'transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                    sliderTrack.style.transform = `translateX(${currentTranslate}px)`;

                    updateDots();
                    
                    if (!instant) {
                        sliderTrack.addEventListener('transitionend', checkLoop, { once: true });
                    } else {
                        isAnimating = false;
                    }
                };
                
                const checkLoop = () => {
                    isAnimating = false;
                    if (realSlideCount <= slidesPerView) return;

                    if (currentSlide < slidesPerView) {
                        currentSlide = currentSlide + realSlideCount;
                        goToSlide(currentSlide, true);
                    } else if (currentSlide >= realSlideCount + slidesPerView) {
                        currentSlide = currentSlide - realSlideCount;
                        goToSlide(currentSlide, true);
                    }
                };

                const startAutoSlide = () => {
                    stopAutoSlide();
                    autoSlideInterval = setInterval(() => {
                        goToSlide(currentSlide + 1);
                    }, 5000);
                };
                
                const stopAutoSlide = () => clearInterval(autoSlideInterval);

                const dragAnimationLoop = () => {
                    if (!isMoving) return;
                    sliderTrack.style.transform = `translateX(${currentTranslate}px)`;
                    animationFrameId = requestAnimationFrame(dragAnimationLoop);
                };

                // 3. DRAG EVENT LISTENERS (UPDATED WITH SWIPE LOGIC)
                const onPointerDown = (e) => {
                    if (isAnimating) return;
                    isDragging = true;
                    isMoving = false;
                    
                    // Capture start time for velocity calculation
                    startTime = new Date().getTime();
                    
                    startPos = e.clientX || e.touches[0].clientX;
                    prevTranslate = currentTranslate;
                    
                    sliderTrack.style.transition = 'none';
                    stopAutoSlide();
                    
                    window.addEventListener('pointermove', onPointerMove);
                    window.addEventListener('pointerup', onPointerUp);
                    window.addEventListener('pointercancel', onPointerUp);
                };

                const onPointerMove = (e) => {
                    if (!isDragging) return;
                    
                    const currentPos = e.clientX || e.touches[0].clientX;
                    dragOffset = currentPos - startPos;
                    currentTranslate = prevTranslate + dragOffset;
                    
                    if (!isMoving) {
                        isMoving = true;
                        animationFrameId = requestAnimationFrame(dragAnimationLoop);
                    }
                };

                const onPointerUp = () => {
                    if (!isDragging) return;
                    isDragging = false;
                    isMoving = false;
                    cancelAnimationFrame(animationFrameId);

                    sliderTrack.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';

                    // === SWIPE DETECTION LOGIC ===
                    const endTime = new Date().getTime();
                    const timeTaken = endTime - startTime;
                    const moveThreshold = 40; // Pixels to count as a "move"
                    
                    let targetSlide = currentSlide;

                    // 1. Check if it was a fast swipe (under 300ms)
                    if (timeTaken < 300 && Math.abs(dragOffset) > moveThreshold) {
                        if (dragOffset < 0) {
                            // Swiped LEFT -> Next Slide
                            targetSlide = currentSlide + 1;
                        } else {
                            // Swiped RIGHT -> Prev Slide
                            targetSlide = currentSlide - 1;
                        }
                    } 
                    // 2. Slow drag: snap to nearest slide based on position
                    else {
                        targetSlide = Math.round(-currentTranslate / slideWidth);
                    }

                    goToSlide(targetSlide); 
                    startAutoSlide();

                    window.removeEventListener('pointermove', onPointerMove);
                    window.removeEventListener('pointerup', onPointerUp);
                    window.removeEventListener('pointercancel', onPointerUp);
                };
                
                sliderTrack.addEventListener('pointerdown', onPointerDown, { passive: true });

                // 4. BUTTON LISTENERS
                nextButton.addEventListener('click', () => {
                    goToSlide(currentSlide + 1);
                    stopAutoSlide();
                });

                prevButton.addEventListener('click', () => {
                    goToSlide(currentSlide - 1);
                    stopAutoSlide();
                });
                
                viewport.addEventListener('mouseenter', stopAutoSlide);
                viewport.addEventListener('mouseleave', startAutoSlide);

                // 5. RESIZE LISTENER
                window.addEventListener('resize', () => {
                    stopAutoSlide();
                    buildSlider(); 
                    startAutoSlide();
                });

                // 6. INITIALIZE
                buildSlider();
                startAutoSlide();
            }
            /* === END: NEW PROJECT SLIDER LOGIC === */

            // --- Testimonial Slider (No changes) ---
            const testimonialSlider = document.getElementById("testimonial-slider");
            if(testimonialSlider && testimonialSlider.children.length > 0) {
                let currentIndex = 0;
                const slides = Array.from(testimonialSlider.children);
                const slideWidth = slides[0].offsetWidth;
                setInterval(() => {
                    currentIndex = (currentIndex + 1) % slides.length;
                    testimonialSlider.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
                }, 5000);
            }
        });
    </script>
</body>
</html>